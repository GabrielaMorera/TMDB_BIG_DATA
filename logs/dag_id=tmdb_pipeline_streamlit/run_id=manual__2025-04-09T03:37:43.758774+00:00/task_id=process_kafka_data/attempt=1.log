[2025-04-09T03:39:36.713+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-04-09T03:39:36.731+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: tmdb_pipeline_streamlit.process_kafka_data manual__2025-04-09T03:37:43.758774+00:00 [queued]>
[2025-04-09T03:39:36.738+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: tmdb_pipeline_streamlit.process_kafka_data manual__2025-04-09T03:37:43.758774+00:00 [queued]>
[2025-04-09T03:39:36.739+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-04-09T03:39:36.750+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): process_kafka_data> on 2025-04-09 03:37:43.758774+00:00
[2025-04-09T03:39:36.758+0000] {standard_task_runner.py:63} INFO - Started process 392 to run task
[2025-04-09T03:39:36.761+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'tmdb_pipeline_streamlit', 'process_kafka_data', 'manual__2025-04-09T03:37:43.758774+00:00', '--job-id', '940', '--raw', '--subdir', 'DAGS_FOLDER/tmdb_pipeline.py', '--cfg-path', '/tmp/tmps4g3vyda']
[2025-04-09T03:39:36.764+0000] {standard_task_runner.py:91} INFO - Job 940: Subtask process_kafka_data
[2025-04-09T03:39:36.806+0000] {task_command.py:426} INFO - Running <TaskInstance: tmdb_pipeline_streamlit.process_kafka_data manual__2025-04-09T03:37:43.758774+00:00 [running]> on host 72535460baeb
[2025-04-09T03:39:36.895+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='tmdb_pipeline_streamlit' AIRFLOW_CTX_TASK_ID='process_kafka_data' AIRFLOW_CTX_EXECUTION_DATE='2025-04-09T03:37:43.758774+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-09T03:37:43.758774+00:00'
[2025-04-09T03:39:36.897+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-04-09T03:39:37.002+0000] {conn.py:395} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=bootstrap-0 host=kafka:9093 <connecting> [IPv4 ('172.19.0.6', 9093)]>: connecting to kafka:9093 [('172.19.0.6', 9093) IPv4]
[2025-04-09T03:39:37.009+0000] {conn.py:615} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=bootstrap-0 host=kafka:9093 <checking_api_versions_recv> [IPv4 ('172.19.0.6', 9093)]>: Broker version identified as 2.6
[2025-04-09T03:39:37.010+0000] {conn.py:456} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=bootstrap-0 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Connection complete.
[2025-04-09T03:39:37.012+0000] {subscription_state.py:182} INFO - Updating subscribed topics to: ('tmdb_data',)
[2025-04-09T03:39:37.012+0000] {tmdb_pipeline.py:1757} INFO - Consumidor Kafka conectado a kafka:9093, tema tmdb_data
[2025-04-09T03:39:37.015+0000] {conn.py:395} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=1001 host=kafka:9093 <connecting> [IPv4 ('172.19.0.6', 9093)]>: connecting to kafka:9093 [('172.19.0.6', 9093) IPv4]
[2025-04-09T03:39:37.016+0000] {conn.py:456} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=1001 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Connection complete.
[2025-04-09T03:39:37.017+0000] {conn.py:936} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=bootstrap-0 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Closing connection. 
[2025-04-09T03:39:38.595+0000] {cluster.py:393} INFO - Group coordinator for movie_analytics_group is ('coordinator-1001', 'kafka', 9093, None)
[2025-04-09T03:39:38.596+0000] {base.py:729} INFO - Discovered coordinator coordinator-1001 for group movie_analytics_group
[2025-04-09T03:39:38.597+0000] {base.py:780} INFO - Starting new heartbeat thread
[2025-04-09T03:39:38.598+0000] {consumer.py:361} INFO - Revoking previously assigned partitions () for group movie_analytics_group
[2025-04-09T03:39:38.600+0000] {conn.py:395} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=coordinator-1001 host=kafka:9093 <connecting> [IPv4 ('172.19.0.6', 9093)]>: connecting to kafka:9093 [('172.19.0.6', 9093) IPv4]
[2025-04-09T03:39:38.602+0000] {conn.py:456} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=coordinator-1001 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Connection complete.
[2025-04-09T03:39:38.703+0000] {base.py:489} INFO - (Re-)joining group movie_analytics_group
[2025-04-09T03:39:38.783+0000] {base.py:552} INFO - Elected group leader -- performing partition assignments using range
[2025-04-09T03:39:39.169+0000] {base.py:380} INFO - Successfully joined group movie_analytics_group with generation 1
[2025-04-09T03:39:39.171+0000] {subscription_state.py:254} INFO - Updated partition assignment: [('tmdb_data', 0)]
[2025-04-09T03:39:39.171+0000] {consumer.py:252} INFO - Setting newly assigned partitions (('tmdb_data', 0),) for group movie_analytics_group
[2025-04-09T03:39:39.348+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Una pequeña confusión
[2025-04-09T03:39:39.349+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Josee, el tigre y los peces
[2025-04-09T03:39:39.349+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Culpa mía
[2025-04-09T03:39:39.349+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: 12 hombres sin piedad
[2025-04-09T03:39:39.349+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El pianista
[2025-04-09T03:39:39.350+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Venom: El último baile
[2025-04-09T03:39:39.350+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Klaus
[2025-04-09T03:39:39.350+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Origen
[2025-04-09T03:39:39.350+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El infierno de Gabriel Parte 3
[2025-04-09T03:39:39.351+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Ghost Game
[2025-04-09T03:39:39.351+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Parásitos
[2025-04-09T03:39:39.351+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: De vuelta a la acción
[2025-04-09T03:39:39.352+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Until Dawn
[2025-04-09T03:39:39.352+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Kraven the Hunter
[2025-04-09T03:39:39.352+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Policán
[2025-04-09T03:39:39.353+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Buffalo Kids
[2025-04-09T03:39:39.353+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Bastion 36
[2025-04-09T03:39:39.353+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: American History X
[2025-04-09T03:39:39.353+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Pulp Fiction
[2025-04-09T03:39:39.354+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Seven: Los Siete Pecados Capitales
[2025-04-09T03:39:39.354+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La leyenda de Hei
[2025-04-09T03:39:39.354+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La acompañante
[2025-04-09T03:39:39.355+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Las Quintillizas: La Película
[2025-04-09T03:39:39.355+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: DJ encubierto
[2025-04-09T03:39:39.355+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: En el bosque de la luz de las luciérnagas
[2025-04-09T03:39:39.356+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Érase una vez en América
[2025-04-09T03:39:39.356+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Minecraft: The Story of Mojang
[2025-04-09T03:39:39.356+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Una película de Minecraft
[2025-04-09T03:39:39.357+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Orgullo y prejuicio
[2025-04-09T03:39:39.357+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Anora
[2025-04-09T03:39:39.357+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: The Monkey
[2025-04-09T03:39:39.357+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Madagascar
[2025-04-09T03:39:39.358+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Cleaner
[2025-04-09T03:39:39.358+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Given: The Movie
[2025-04-09T03:39:39.358+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Gladiator II
[2025-04-09T03:39:39.358+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Clouds
[2025-04-09T03:39:39.359+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Culpa tuya
[2025-04-09T03:39:39.359+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Green Book
[2025-04-09T03:39:39.359+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La tumba de las luciérnagas
[2025-04-09T03:39:39.360+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El rey león
[2025-04-09T03:39:39.360+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Scream
[2025-04-09T03:39:39.360+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La cita
[2025-04-09T03:39:39.360+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Una noche en Zoopolis
[2025-04-09T03:39:39.361+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: A dos metros de ti
[2025-04-09T03:39:39.361+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Norma: Antara Mertua dan Menantu
[2025-04-09T03:39:39.361+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Gru 4. Mi villano favorito
[2025-04-09T03:39:39.361+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Henry Danger: La película
[2025-04-09T03:39:39.362+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Oni-Goroshi: Ciudad de los demonios
[2025-04-09T03:39:39.362+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Senderos de gloria
[2025-04-09T03:39:39.362+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Mientras Cupido no está
[2025-04-09T03:39:39.362+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Códigos de Guerra
[2025-04-09T03:39:39.363+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Queer
[2025-04-09T03:39:39.363+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Opus
[2025-04-09T03:39:39.363+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La chica de la aguja
[2025-04-09T03:39:39.363+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Puri for Rent
[2025-04-09T03:39:39.364+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Mulholland Drive
[2025-04-09T03:39:39.364+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Vengadores: Infinity War
[2025-04-09T03:39:39.365+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Presence
[2025-04-09T03:39:39.365+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Your Name
[2025-04-09T03:39:39.365+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La guerra de las galaxias. Episodio III: La venganza de los Sith
[2025-04-09T03:39:39.365+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Mufasa: El rey león
[2025-04-09T03:39:39.366+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Tierras perdidas
[2025-04-09T03:39:39.366+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Popeye the Slayer Man
[2025-04-09T03:39:39.366+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Amenaza en el aire
[2025-04-09T03:39:39.366+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Un amor contra viento y marea
[2025-04-09T03:39:39.367+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Los siete samuráis
[2025-04-09T03:39:39.367+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La venganza de Cenicienta
[2025-04-09T03:39:39.367+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: So Won
[2025-04-09T03:39:39.368+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Estado eléctrico
[2025-04-09T03:39:39.368+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Mi lista de deseos
[2025-04-09T03:39:39.368+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El maestro del crimen
[2025-04-09T03:39:39.369+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Los pecadores
[2025-04-09T03:39:39.369+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Evangelion: 3.0+1.01 Thrice Upon a Time
[2025-04-09T03:39:39.369+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Toda una vida
[2025-04-09T03:39:39.369+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Cómo ganar millones antes de que muera la abuela
[2025-04-09T03:39:39.370+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: La princesa Mononoke
[2025-04-09T03:39:39.370+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Blindado
[2025-04-09T03:39:39.370+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Death of a Unicorn
[2025-04-09T03:39:39.370+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El padrino
[2025-04-09T03:39:39.371+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Capitán América: Brave New World
[2025-04-09T03:39:39.371+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El Club de la Lucha
[2025-04-09T03:39:39.371+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Vengadores: Endgame
[2025-04-09T03:39:39.371+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Érase una vez un estudio
[2025-04-09T03:39:39.372+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: G20
[2025-04-09T03:39:39.372+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Taylor Swift: Gira de estadios Reputation
[2025-04-09T03:39:39.372+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Regreso al futuro
[2025-04-09T03:39:39.373+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Dark Match
[2025-04-09T03:39:39.373+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Emmanuelle
[2025-04-09T03:39:39.373+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Z Zone
[2025-04-09T03:39:39.373+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: El Padrino Parte II
[2025-04-09T03:39:39.374+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: xXx
[2025-04-09T03:39:39.374+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Gabriel's Inferno: Part II
[2025-04-09T03:39:39.374+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Al otro barrio
[2025-04-09T03:39:39.374+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Fight or Flight
[2025-04-09T03:39:39.375+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Luces de la ciudad
[2025-04-09T03:39:39.375+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Tiempos modernos
[2025-04-09T03:39:39.375+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Harakiri
[2025-04-09T03:39:39.375+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Robot salvaje
[2025-04-09T03:39:39.376+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Toda una vida en un año
[2025-04-09T03:39:39.376+0000] {tmdb_pipeline.py:1766} INFO - Película recibida de Kafka: Quiero comerme tu páncreas
[2025-04-09T03:40:39.378+0000] {tmdb_pipeline.py:1768} INFO - Consumidos 100 mensajes de Kafka
[2025-04-09T03:40:39.381+0000] {tmdb_pipeline.py:1801} INFO - Procesando 100 mensajes con Pandas
[2025-04-09T03:40:39.430+0000] {tmdb_pipeline.py:1905} ERROR - Error en el procesamiento: sequence item 0: expected str instance, dict found
[2025-04-09T03:40:39.435+0000] {tmdb_pipeline.py:1906} ERROR - Traceback (most recent call last):
  File "/opt/***/dags/tmdb_pipeline.py", line 1840, in process_kafka_data
    df['cast_str'] = df['cast'].apply(lambda x: ','.join(x) if isinstance(x, list) else '')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/pandas/core/series.py", line 4764, in apply
    ).apply()
      ^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/pandas/core/apply.py", line 1209, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/pandas/core/apply.py", line 1289, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.12/site-packages/pandas/core/algorithms.py", line 1814, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib.pyx", line 2926, in pandas._libs.lib.map_infer
  File "/opt/***/dags/tmdb_pipeline.py", line 1840, in <lambda>
    df['cast_str'] = df['cast'].apply(lambda x: ','.join(x) if isinstance(x, list) else '')
                                                ^^^^^^^^^^^
TypeError: sequence item 0: expected str instance, dict found

[2025-04-09T03:40:39.441+0000] {base.py:794} INFO - Stopping heartbeat thread
[2025-04-09T03:40:42.442+0000] {base.py:995} WARNING - Heartbeat thread did not fully terminate during close
[2025-04-09T03:40:42.443+0000] {base.py:823} INFO - Leaving consumer group (movie_analytics_group).
[2025-04-09T03:40:42.482+0000] {conn.py:936} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=1001 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Closing connection. 
[2025-04-09T03:40:42.484+0000] {conn.py:936} INFO - <BrokerConnection client_id=kafka-python-2.1.5, node_id=coordinator-1001 host=kafka:9093 <connected> [IPv4 ('172.19.0.6', 9093)]>: Closing connection. 
[2025-04-09T03:40:42.485+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-04-09T03:40:42.487+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/tmdb_pipeline.py", line 1840, in process_kafka_data
    df['cast_str'] = df['cast'].apply(lambda x: ','.join(x) if isinstance(x, list) else '')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/series.py", line 4764, in apply
    ).apply()
      ^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/apply.py", line 1209, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/apply.py", line 1289, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/algorithms.py", line 1814, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib.pyx", line 2926, in pandas._libs.lib.map_infer
  File "/opt/airflow/dags/tmdb_pipeline.py", line 1840, in <lambda>
    df['cast_str'] = df['cast'].apply(lambda x: ','.join(x) if isinstance(x, list) else '')
                                                ^^^^^^^^^^^
TypeError: sequence item 0: expected str instance, dict found
[2025-04-09T03:40:42.519+0000] {taskinstance.py:1205} INFO - Marking task as UP_FOR_RETRY. dag_id=tmdb_pipeline_streamlit, task_id=process_kafka_data, execution_date=20250409T033743, start_date=20250409T033936, end_date=20250409T034042
[2025-04-09T03:40:42.559+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 940 for task process_kafka_data (sequence item 0: expected str instance, dict found; 392)
[2025-04-09T03:40:42.616+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-04-09T03:40:42.674+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-09T03:40:42.676+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
